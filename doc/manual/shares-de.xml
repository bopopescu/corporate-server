<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE chapter [
	<!ENTITY % extensions SYSTEM "../stylesheets/macros.ent" >
	<!ENTITY % DocBookDTD PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
	"http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd">
	<!ENTITY % entities SYSTEM "../stylesheets/macros-de.ent" >
	%extensions;
	%DocBookDTD;
	%entities;
]>
<chapter id="shares::general">
  <title>Freigaben-Verwaltung</title>
  <para>
	UCS unterstützt die zentrale Verwaltung von Verzeichnisfreigaben. Eine in &ucsUMC;
	registrierte Freigabe wird im Rahmen der UCS-Domänenreplikation auf beliebigen Serversystemen
	der UCS-Domäne angelegt.
  </para>

  <para>
	Die Bereitstellung für die zugreifenden Clients kann über CIFS (unterstützt von
	Windows/Linux-Clients) und/oder NFS (vorrangig unterstützt von Linux/Unix) erfolgen. Die in der
	&ucsUMC; verwalteten NFS-Freigaben können von Clients sowohl über NFSv3, als auch über NFSv4
	eingebunden werden.
  </para>

  <para>
	Wird eine Verzeichnisfreigabe gelöscht, bleiben die in dem Verzeichnis freigegebenen Daten auf
	einem Server erhalten.
  </para>

  <para>
	Um auf einer Freigabe Access Control Lists einzusetzen, muss das unterliegende Linux-Dateisystem
	POSIX-ACLs unterstützen. In UCS unterstützen die Dateisysteme <systemitem class="filesystem">ext3</systemitem>, <systemitem class="filesystem">ext4</systemitem> und <systemitem class="filesystem">XFS</systemitem> POSIX-ACLs. Die
	Samba-Konfiguration erlaubt außerdem die Speicherung von DOS-Datei-Attributen in erweiterten
	Attributen des Unix-Dateisystems. Um erweiterte Attribute zu nutzen, muss die Partition mit der
	Mount-Option <option>user_xattr</option> eingebunden werden.
  </para>

  <section id="shares::permissions"><title>Zugriffsrechte auf Daten in Freigaben</title>
  <para>
	Die Verwaltung von Zugriffsrechten auf Dateien erfolgt in UCS anhand von Benutzern
	und Gruppen. Alle Fileserver der UCS-Domäne greifen über das LDAP-Verzeichnis
	auf identische Benutzer- und Gruppendaten zu.
  </para>
  <para>
	Pro Datei werden drei Zugriffsrechte unterschieden: Lesen, Schreiben und
	Ausführen. Pro Verzeichnis gelten ebenfalls drei Zugriffsrechte: Ebenso Lesen und
	Schreiben, das Ausführ-Recht bezieht sich hier auf die Berechtigung in ein
	Verzeichnis zu wechseln.
  </para>

  <para>
	Jede Datei/Verzeichnis wird von einem Benutzer und einer Gruppe besessen. Die
	drei oben genannten Rechte können jeweils auf den Besitzer, die
	Besitzer-Gruppe und alle anderen angewendet werden.
  </para>

  <para>
	Ist die <emphasis>setuid</emphasis>-Option für eine ausführbare Datei gesetzt, kann diese von
	Benutzern mit den Rechten des Besitzers oder der Besitzergruppe ausgeführt werden.
  </para>

  <para>
	Wird die Option <emphasis>setgid</emphasis> für ein Verzeichnis gesetzt, erben dort angelegte
	Dateien die Besitzergruppe des Verzeichnisses. Werden weitere Verzeichnisse angelegt, erben
	diese ebenfalls die Option.
  </para>

  <para>
	Ist die Option <emphasis>sticky bit</emphasis> für ein Verzeichnis aktiviert, können Dateien in dem
	Verzeichnis nur von dem Besitzer der Datei oder durch den root-Benutzer gelöscht werden.
  </para>

  <para>
	Mit Access Control Lists sind noch mächtigere Berechtigungsmodelle
	möglich. Die Konfiguration von ACLs ist in <u:sdb>1042</u:sdb> beschrieben.
  </para>
  <para>
	Im Unix-Berechtigungsmodell - und somit unter UCS - reicht das Schreibrecht
	auf eine Datei nicht aus, um die Berechtigungen einer Datei zu verändern. Dies
	bleibt den Besitzern/der Besitzergruppe einer Datei vorbehalten.
	Unter Microsoft Windows hingegen verfügen alle Benutzer mit Schreibrechten
	auch die über Berechtigung, die Berechtigungen anzupassen. Dieses
	Verhalten kann für CIFS-Freigaben angepasst werden (siehe
	<xref linkend="shares::management"/>).
  </para>
  <para>
	Beim Anlegen einer Verzeichnisfreigabe werden nur initiale Besitzer und Zugriffsrechte
	vergeben. Existiert das Verzeichnis bereits, werden die Berechtigungen des vorhandenen
	Verzeichnisses angepasst.
  </para>
  <para>
	Berechtigungsänderungen an einem freigegebenen Verzeichnis, die direkt im Dateisystem
	vorgenommen wurden, werden nicht an das LDAP-Verzeichnis weitergeleitet.
	Wird die Berechtigungen/Besitzer in &ucsUMC; bearbeitet, werden die Änderungen im
	Dateisystem überschrieben. Einstellungen der Freigabewurzel sollten deshalb nur mit
	&ucsUMC; gesetzt und bearbeitet werden. Die weitere Anpassung der
	Zugriffsrechte der unterliegenden Verzeichnisses erfolgt dann von den
	zugreifenden Clients, z.B. über den Windows-Explorer, oder direkt über
	Kommandozeilenbefehle auf dem Fileserver.
  </para>
  <para>
	Die Freigabe <emphasis>homes</emphasis> nimmt unter Samba eine Sonderstellung ein. Sie dient
	der Freigabe der Heimatverzeichnisse der Benutzer. Für jeden Benutzer wird
	diese Freigabe automatisch in das eigene Heimatverzeichnis
	umgewandelt. Deswegen ignoriert Samba die der Freigabe zugewiesenen Rechte
	und verwendet die Rechte des jeweiligen Heimatverzeichnisses.
  </para>
  </section>

<section id="shares::management"><title>Verwaltung von Freigaben in UMC</title>
<para>
	Verzeichnisfreigaben werden im UMC-Modul <emphasis>Freigaben</emphasis> verwaltet
	(siehe auch <xref linkend="central:user-interface"/>).
</para>

<para>
Beim Hinzufügen/Bearbeiten/Entfernen einer Freigabe wird diese in die
Datei <filename>/etc/exports</filename>, bzw. in die Samba-Konfigurationsdatei
eingetragen/modifiziert oder entfernt.
</para>

<figure id="shares:create"><title>Anlegen einer Freigabe in UMC</title>
 <graphic scalefit="1" width="100%" fileref="illustrations44/projekt-freigabe_DE.png"/>
</figure>

<table>
  <title>Reiter 'Allgemein'</title>
  <tgroup cols="2">
	<colspec colnum="1" colname="col1" colwidth="1*"/>
	<colspec colnum="2" colname="col2" colwidth="2*"/>
	<thead>
	  <row>
		<entry>Attribut</entry>
		<entry>Beschreibung</entry>
	  </row>
	</thead>
	<tbody>

	  <row>
		<entry>Name</entry>
		<entry>
		  Hier ist der Name der Freigabe einzutragen.
		  Der Name darf nur aus Buchstaben, Ziffern, Punkten oder Leerzeichen bestehen
		  und muss mit mit einem Buchstaben oder einer Ziffer beginnen und enden.
		</entry>
	  </row>

	  <row>
		<entry>Server</entry>
		<entry>
		  Der Server, auf dem die Freigabe liegt. Zur Wahl stehen alle im
		  LDAP-Verzeichnis für die Domäne eingetragenen Rechner vom Typ
		  Domänencontroller Master/Backup/Slave und &ucsMember;, die in einer DNS
		  Forward Lookup Zone im LDAP-Verzeichnis eingetragen sind.
		</entry>
	  </row>

	  <row>
		<entry>Pfad</entry>
		<entry>
		  <para>
			Der absolute Pfad des freizugebenden Verzeichnisses ohne Anführungszeichen
			(auch wenn der Pfad z.B. Leerzeichen enthält). Wenn das Verzeichnis noch nicht
			existiert, wird es automatisch auf dem ausgewählten Server angelegt.
		  </para>

		  <para>
			Ist die &ucsUCRV; <envar>listener/shares/rename</envar> auf <literal>yes</literal> gesetzt, wird
			bei der Änderung des Pfads der Inhalt eines bestehenden Verzeichnisses verschoben.
		  </para>
		  <para>
			Auf und unterhalb von <filename class="directory">/proc</filename>, <filename class="directory">/tmp</filename>, <filename class="directory">/root</filename>, <filename class="directory">/dev</filename>
			und <filename class="directory">/sys</filename> können keine Freigaben angelegt oder dorthin
			verschoben werden.
		  </para>
		</entry>
	  </row>

	  <row>
		<entry>Besitzer des Wurzelverzeichnis der Freigabe</entry>
		<entry>
		  Der Benutzer, der das Wurzelverzeichnis der Freigabe gehören soll, siehe
		  <xref linkend="shares::permissions"/>.
		</entry>
	  </row>

	  <row>
		<entry>Besitzergruppe für das Wurzelverzeichnis der Freigabe</entry>
		<entry>
		  Die Gruppe, der das Wurzelverzeichnis der Freigabe gehören soll, siehe
		  <xref linkend="shares::permissions"/>.
		</entry>
	  </row>

	  <row>
		<entry>Dateiberechtigungen für das Wurzelverzeichnis der Freigabe</entry>
		<entry>
		  Die Lese-, Schreib- und Zugriffsrechte für das Wurzelverzeichnis der Freigabe,
		  siehe <xref linkend="shares::permissions"/>.
		</entry>
	  </row>

	</tbody>
  </tgroup>
</table>

<table>
  <title>Reiter 'NFS'</title>
  <tgroup cols="2">
	<colspec colnum="1" colname="col1" colwidth="1*"/>
	<colspec colnum="2" colname="col2" colwidth="2*"/>
	<thead>
	  <row>
		<entry>Attribut</entry>
		<entry>Beschreibung</entry>
	  </row>
	</thead>
	<tbody>

	  <row>
		<entry>NFS-Schreibzugriff</entry>
		<entry>
		  Erlaubt schreibenden NFS-Zugriff auf diese Freigabe, ansonsten kann die
		  Freigabe nur lesend verwendet werden.
		</entry>
	  </row>

	  <row>
		<entry>Subtree-Überprüfung</entry>
		<entry>
		  Wird nur ein Unterverzeichnis eines Dateisystems exportiert, muss der
		  NFS-Server bei jedem Zugriff überprüfen, ob die zugegriffene Datei auf dem
		  exportierten Dateisystem und in dem exportierten Pfad liegt. Für diese Prüfung
		  werden Pfad-Informationen an den Client übergeben. Die Aktivierung dieser
		  Funktion kann zu Problemen führen, wenn eine auf dem Client geöffnete Datei
		  umbenannt wird.
		</entry>
	  </row>

	  <row>
		<entry>User-ID für Root-Benutzer ändern (Root-Squashing)</entry>
		<entry>
		  <para>
			Die Identifikation von Nutzern im NFS-Standardverfahren erfolgt über
			User-IDs. Um zu verhindern, dass ein lokaler Root-Nutzer auf fremden Freigaben
			ebenfalls mit Root-Rechten arbeitet, kann der Root-Zugriff umgelenkt
			werden. Ist diese Option aktiviert, erfolgen Root-Zugriffe als Benutzer nobody.
		  </para>

		  <para>
			Die standardmäßig leere lokale Gruppe <systemitem class="groupname">staff</systemitem> verfügt über Privilegien, die
			<systemitem class="username">root</systemitem>-Rechten recht nahe kommen, wird aber vom Umlenkungs-Mechanismus
			nicht berücksichtigt. Dies sollte bei der Aufnahme von Nutzern in diese Gruppe
			berücksichtigt werden!
		  </para>
		</entry>
	  </row>

	  <row>
		<entry>NFS-Synchronisation</entry>
		<entry>
		  Der Synchronisations-Modus für die Freigabe. Mit der Einstellung <option>sync</option>
		  werden Daten direkt auf das unterliegende Speichermedium geschrieben. Die
		  gegenteilige Einstellung - <option>async</option> - kann die Performance verbessern,
		  birgt aber auch das Risiko von Datenverlusten wenn der Server ohne
		  kontrolliertes Herunterfahren abgeschaltet wird.
		</entry>
	  </row>

	  <row>
		<entry>Zugriff nur für diese Rechner, IP-Adressen oder Netze erlauben</entry>
		<entry>
		  Standardmäßig wird allen Rechnern der Zugriff auf eine Freigabe erlaubt. In
		  die Auswahlliste können Rechnernamen und IP-Adressen aufgenommen werden, auf
		  die dann der Zugriff auf die Freigabe beschränkt wird. Hier ließe sich etwa der
		  Zugriff auf eine Freigabe mit Maildaten auf den Mailserver der Domäne einschränken.
		</entry>
	  </row>

	</tbody>
  </tgroup>
</table>


<table>
  <title>Reiter 'Samba'</title>
  <tgroup cols="2">
	<colspec colnum="1" colname="col1" colwidth="1*"/>
	<colspec colnum="2" colname="col2" colwidth="2*"/>
	<thead>
	  <row>
		<entry>Attribut</entry>
		<entry>Beschreibung</entry>
	  </row>
	</thead>
	<tbody>

	  <row>
		<entry>Samba-Name</entry>
		<entry>
		  Der NetBIOS-Name der Freigabe. Unter diesem Namen wird die Freigabe auf
		  auf Windows-Rechnern in der Netzwerkumgebung angezeigt.. &ucsUMC; übernimmt
		  beim Hinzufügen einer Verzeichnisfreigabe als Vorgabe den Namen, der auf der
		  Karteikarte <guimenu>Allgemein</guimenu> im Feld <guimenu>Name</guimenu>
		  eingetragen ist.
		</entry>
	  </row>

	  <row>
		<entry>Samba-Schreibzugriff</entry>
		<entry>
		  Erlaubt den Schreibzugriff auf diese Freigabe.
		</entry>
	  </row>

	  <row>
		<entry>Freigabe wird in der Windows-Netzwerkumgebung angezeigt</entry>
		<entry>
		  Konfiguriert, ob diese Freigabe auf Windows-Rechnern in der Netzwerkumgebung
		  angezeigt werden soll.
		</entry>
	  </row>

	  <row>
		<entry>Anonymen Nur-Lese-Zugriff mit Gastbenutzer erlauben</entry>
		<entry>
		  Erlaubt den Zugriff auf diese Freigabe ohne Passwortabfrage. Alle Zugriffe
		  werden dabei über einen gemeinsamen Gast-Nutzer <systemitem class="username">nobody</systemitem> durchgeführt.
		</entry>
	  </row>

	  <row>
		<entry>MSDFS-Wurzel</entry>
		<entry>
		  Diese Option ist in <xref linkend="shares::msdfs"/> dokumentiert.
		</entry>
	  </row>

	  <row>
		<entry>Benutzer mit Schreibrechten dürfen die Berechtigungen verändern</entry>
		<entry>
		  Wird diese Option aktiviert, erhalten alle Benutzer mit
		  Schreibrechten auf eine Datei auch die Möglichkeiten Berechtigungen,
		  ACL-Einträge und Dateibesitzrechte zu ändern, siehe
		  <xref linkend="shares::permissions"/>.
		</entry>
	  </row>

	  <row>
		<entry>Verstecke nicht lesbare Dateien und Verzeichnisse</entry>
		<entry>
		  Wenn diese Option aktiviert ist, werden Dateien, die anhand der Dateirechte
		  für einen Benutzer nicht lesbar sind, für diesen nicht angezeigt.
		</entry>
	  </row>

	  <row>
		<entry>VFS-Objekte</entry>
		<entry>
		  Virtual File System (VFS)-Module werden in Samba verwendet, um Aktionen vor dem Zugriff auf das
		  Dateisystem einer Freigabe auszuführen, z.B. ein Virenscanner, der jede
		  infizierte Datei, auf die in der Freigabe zugegriffen wird, in einem
		  Quarantänebereich ablegt oder eine serverseitige Implementierung einer
		  Papierkorb-Löschung von Dateien.
		</entry>
	  </row>

	</tbody>
  </tgroup>
</table>


<table>
  <title>Reiter 'Samba-Rechte' (erweiterte Einstellungen)</title>
  <tgroup cols="2">
	<colspec colnum="1" colname="col1" colwidth="1*"/>
	<colspec colnum="2" colname="col2" colwidth="2*"/>
	<thead>
	  <row>
		<entry>Attribut</entry>
		<entry>Beschreibung</entry>
	  </row>
	</thead>
	<tbody>


	  <row>
		<entry>Erzwungener Benutzer</entry>
		<entry>
		  Der Benutzername, mit dessen Namen, Rechten und primärer Gruppe alle
		  Dateioperationen zugreifender Benutzer ausgeführt werden sollen. Der Benutzername
		  wird erst verwendet, nachdem der Benutzer mit seinem tatsächlichen
		  Benutzernamen und gültigem Passwort eine Verbindung zur Samba-Freigabe
		  aufgebaut hat. Ein gemeinsamer Benutzername ist nützlich, um Dateien
		  gemeinsam zu benutzen, kann bei falscher Anwendung aber Sicherheitsprobleme
		  verursachen.
		</entry>
	  </row>

	  <row>
		<entry>Erzwungene Gruppe</entry>
		<entry>
		  <para>
			Eine Gruppe, die alle Benutzer, die sich mit dieser Freigabe verbinden, als
			primäre Gruppe verwenden sollen. Dadurch gelten die Rechte dieser Gruppe als
			Gruppenrechte für alle diese Benutzer. Eine hier eingetragene Gruppe hat
			Vorrang über eine Gruppe, die über das Eingabefeld <guimenu>Erzwungener
			</guimenu> zur primären Gruppe eines Benutzers geworden ist.
		  </para>

		  <para>
			Wird dem Gruppennamen ein Plus-Zeichen vorangestellt, wird die Gruppe nur
			solchen Benutzern als primäre Gruppe zugeschrieben, die bereits Mitglied
			dieser Gruppe sind. Alle anderen Benutzer behalten ihre gewöhnliche primäre
			Gruppe
		  </para>
		</entry>
	  </row>

	  <row>
		<entry>Gültige Benutzer oder Gruppen</entry>
		<entry>
		  <para>
			Namen von Benutzern oder Gruppen, die auf diese Samba-Freigabe zugreifen
			dürfen. Alle anderen Benutzern wird der Zugriff verweigert.
			Wenn das Feld leer ist, dürfen alle Benutzer - ggf. mit ihrem
			Passwort - auf die Freigabe zugreifen. Diese Option ist nützlich, um Zugriffe
			auf eine Freigabe über die Dateiberechtigungen hinaus auf Ebene des
			Fileservers abzusichern.
		  </para>

		  <para>
			Die Einträge sind durch Leerzeichen zu trennen. Durch die Zeichen @, + und &amp; in
			Verbindung mit einem Gruppennamen kann den Mitgliedern der angegebenen Gruppe
			die Berechtigung zum Zugriff auf die Samba-Freigabe erteilt werden:
		  </para>
		  <itemizedlist>
			<listitem>
			  <simpara>
				Ein Name, der mit @ beginnt, wird zunächst als NIS-Netgroup
				interpretiert. Wenn keine NIS-Netgroup mit diesem Namen gefunden wird, wird
				der Name als UNIX-Gruppe angesehen.
			  </simpara>
			</listitem>
			<listitem>
			  <simpara>
				Ein Name, der mit + beginnt, wird ausschließlich als UNIX-Gruppe
				aufgefasst, ein Name, der mit &amp; beginnt, ausschließlich als NIS-Netgroup.
			  </simpara>
			</listitem>
			<listitem>
			  <simpara>
				Ein Name, der mit +&amp; beginnt, wird zunächst als UNIX-Gruppe
				interpretiert. Wenn keine UNIX-Gruppe mit diesem Namen gefunden wird, wird der
				Name als NIS-Netgroup betrachtet. Die Zeichen &amp;+ als Namensanfang entsprechen @.
			  </simpara>
			</listitem>
		  </itemizedlist>
		</entry>
	  </row>

	  <row>
		<entry>Nicht erlaubte Benutzer oder Gruppen</entry>
		<entry>
		  Die hier aufgeführten Benutzer oder Gruppen dürfen auf diese Samba-Freigabe
		  nicht zugreifen. Die Syntax ist identisch zu den gültigen Benutzern. Wenn ein
		  Benutzer oder eine Gruppe in der Liste der gültigen Benutzer und der nicht
		  erlaubten Benutzer enthalten ist, so wird der Zugriff verweigert.
		</entry>
	  </row>

	  <row>
		<entry>Schreibberechtigung auf diese Benutzer/Gruppen beschränken</entry>
		<entry>
		  Nur die aufgeführten Benutzer oder Gruppen erhalten Schreibrecht auf die
		  diese Freigabe.
		</entry>
	  </row>

	  <row>
		<entry>Zugelassene Rechner/Netze</entry>
		<entry>
		  Namen von Rechnern, die auf diese Samba-Freigabe zugreifen dürfen. Allen
		  anderen Rechnern wird der Zugriff verweigert.
		  Neben Rechnernamen können auch IP- oder Netzwerkadressen angegeben werden, bspw.
		  <userinput>192.0.2.0/255.255.255.0</userinput>.
		</entry>
	  </row>

	  <row>
		<entry>Nicht zugelassene Rechner/Netze</entry>
		<entry>
		  Das Gegenteil von den zugelassenen Rechnern. Sollte ein Rechner in beiden
		  Listen auftauchen, so wird dem Rechner der Zugriff auf die Samba-Freigabe
		  gestattet.
		</entry>
	  </row>

	  <row>
		<entry>NT ACL-Support</entry>
		<entry>
		  <para>
			Ist diese Option aktiviert, versucht Samba, POSIX-ACLs unter
			Windows anzuzeigen und Änderungen an den ACLs, die unter Windows vorgenommen
			werden, in die POSIX-ACLs zu übernehmen.
		  </para>

		  <para>
			Wenn die Option nicht gesetzt ist, werden vorhandene POSIX-ACLs beachtet, aber
			nicht unter Windows angezeigt und können von dort nicht verändert werden.
		  </para>
		</entry>
	  </row>

	  <row>
		<entry>Ererbte ACLs</entry>
		<entry>
		  Bei Aktivierung dieser Option erbt jede in dieser Freigabe neu erzeugte Datei die ACL
		  (Access Control List) des Verzeichnisses, in dem sie angelegt wird.
		</entry>
	  </row>

	  <row>
		<entry>Neue Dateien und Verzeichnisse erhalten den Besitzer des übergeordneten Verzeichnisses</entry>
		<entry>
		  Bei Aktivierung dieser Option wird jede neu erzeugte Datei dem Besitzer des
		  übergeordneten Verzeichnis zugeordnet und nicht dem Benutzer, der die Datei
		  erstellt hat.
		</entry>
	  </row>

	  <row>
		<entry>Neue Dateien und Verzeichnisse erhalten die Zugriffsrechte des übergeordneten Verzeichnisses</entry>
		<entry>
		  Bei Aktivierung dieser Option werden für jede Datei oder jedes Verzeichnis,
		  die in einer Freigabe neu erzeugt werden, automatisch die UNIX-Rechte des
		  übergeordneten Verzeichnisses übernommen.
		</entry>
	  </row>

	</tbody>
  </tgroup>
</table>


<para>
Wenn von einem Windows-Rechner aus eine neue Datei auf einem Samba-Server
angelegt wird, werden die Rechte der Datei in mehreren Schritten gesetzt.
</para>

<orderedlist>
	<listitem>
		<simpara>
			Zunächst werden die DOS-Rechte in Unix-Rechte übersetzt.
		</simpara>
	</listitem>
	<listitem>
		<simpara>
			Anschließend werden die Rechte durch den <guimenu>Datei-Modus</guimenu> gefiltert. Nur
  die Unix-Rechte, die im Datei-Modus markiert sind, bleiben erhalten. Rechte,
  die hier nicht gesetzt sind, werden entfernt. Die Rechte müssen also als
  Unix-Rechte und im Datei-Modus gesetzt sein, um erhalten zu bleiben.
		</simpara>
	</listitem>
	<listitem>
		<simpara>
		Im nächsten Schritt werden die Rechte um die unter <guimenu>Erzwinge Datei-Modus</guimenu>
  gesetzten Rechte ergänzt. Als Ergebnis hat die Datei alle Rechte, die nach
  Schritt 2 oder unter <guimenu>Erzwinge Datei-Modus</guimenu> gesetzt sind.
  Rechte, die unter <guimenu>Erzwinge Datei-Modus</guimenu> markiert sind, werden also auf jeden
  Fall gesetzt.
		</simpara>
	</listitem>
</orderedlist>

<para>
Entsprechend erhält ein neu angelegtes Verzeichnis zunächst die Rechte, die
sowohl als Unix-Rechte als auch im <guimenu>Verzeichnis-Modus</guimenu> gesetzt sind. Danach
werden die Rechte ergänzt, die unter <guimenu>Erzwinge Verzeichnis-Modus</guimenu> markiert sind.
</para>
<para>
In ähnlicher Weise werden die Sicherheits-Einstellungen auf bestehende Dateien
und Verzeichnisse angewandt, deren Rechte unter Windows bearbeitet werden:
</para>
<para>
Ausschließlich Rechte, die im <guimenu>Sicherheits-Modus</guimenu>
bzw. <guimenu>Sicherheits-Verzeichnis-Modus</guimenu> markiert sind, können von
Windows aus verändert werden. Anschließend werden die Rechte, die
unter <guimenu>Erzwinge Sicherheits-Modus</guimenu> bzw. <guimenu>Erzwinge Sicherheits-Verzeichnis-Modus</guimenu>
markiert sind, auf jeden Fall gesetzt.
</para>
<para>
Die Parameter <guimenu>Datei-Modus</guimenu> und <guimenu>Erzwinge Datei-Modus</guimenu>
bzw. <guimenu>Verzeichnis-Modus</guimenu> und <guimenu>Erzwinge Verzeichnis-Modus</guimenu>
finden also beim Anlegen einer Datei bzw. eines
Verzeichnisses Anwendung, die Parameter <guimenu>Sicherheits-Modus</guimenu>
und <guimenu>Erzwinge Sicherheits-Modus</guimenu>
bzw. <guimenu>Sicherheits-Verzeichnis-Modus</guimenu> und <guimenu>Erzwinge Sicherheits-Verzeichnis-Modus</guimenu>
beim Ändern der Rechte.
</para>
<note>
<para>
Es ist zu beachten, dass sich die Sicherheitseinstellungen nur auf den Zugriff
über Samba beziehen.
</para>
<para>
Der Benutzer auf Windows-Seite erhält keinen Hinweis, dass die Datei-
bzw. Verzeichnisrechte gegebenenfalls entsprechend den Samba-Einstellungen auf
dieser Karteikarte verändert werden.
</para>
</note>

<table>
  <title>Reiter 'Erweiterte Samba-Rechte' (erweiterte Einstellungen)</title>
  <tgroup cols="2">
	<colspec colnum="1" colname="col1" colwidth="1*"/>
	<colspec colnum="2" colname="col2" colwidth="2*"/>
	<thead>
	  <row>
		<entry>Attribut</entry>
		<entry>Beschreibung</entry>
	  </row>
	</thead>
	<tbody>

	  <row>
		<entry>Datei-Modus</entry>
		<entry>
		  Die Rechte, die Samba beim Anlegen einer Datei übernehmen soll, sofern sie
		  unter Windows gesetzt sind.
		</entry>
	  </row>

	  <row>
		<entry>Verzeichnis-Modus</entry>
		<entry>
		  Die Rechte, die Samba beim Anlegen eines Verzeichnisses übernehmen soll,
		  sofern sie unter Windows gesetzt sind.
		</entry>
	  </row>

	  <row>
		<entry>Erzwinge Datei-Modus</entry>
		<entry>
		  Die Rechte, die Samba beim Anlegen einer Datei auf jeden
		  Fall setzen soll, also unabhängig davon, ob sie unter Windows gesetzt wurden
		  oder nicht.
		</entry>
	  </row>

	  <row>
		<entry>Erzwinge Verzeichnis-Modus</entry>
		<entry>
		  Die Rechte, die Samba beim Anlegen eines Verzeichnisses
		  auf jeden Fall setzen soll, also unabhängig davon, ob sie unter Windows
		  gesetzt wurden oder nicht.
		</entry>
	  </row>

	  <row>
		<entry>Sicherheitsmodus</entry>
		<entry>
		  Die Dateirechte, an denen Samba Änderungen von Windows-Seite aus zulassen soll.
		</entry>
	  </row>

	  <row>
		<entry>Verzeichnis-Sicherheitsmodus</entry>
		<entry>
		  Die Verzeichnisrechte, an denen Samba Änderungen von Windows-Seite aus
		  zulassen soll.
		</entry>
	  </row>

	  <row>
		<entry>Erzwinge Sicherheitsmodus</entry>
		<entry>
		  Die Rechte, die Samba auf jeden Fall setzen soll (unabhängig davon, ob die
		  Rechte unter Windows gesetzt wurden oder nicht), wenn die Rechte einer Datei
		  von Windows-Seite aus geändert werden.
		</entry>
	  </row>

	  <row>
		<entry>Erzwinge Verzeichnis-Sicherheitsmodus</entry>
		<entry>
		  Die Rechte, die Samba auf jeden Fall setzen soll, wenn die Rechte eines
		  Verzeichnisses von Windows-Seite aus geändert werden (unabhängig davon, ob die
		  Rechte unter Windows gesetzt wurden oder nicht).
		</entry>
	  </row>

	</tbody>
  </tgroup>
</table>



<table>
  <title>Reiter 'Samba-Optionen' (erweiterte Einstellungen)</title>
  <tgroup cols="2">
	<colspec colnum="1" colname="col1" colwidth="1*"/>
	<colspec colnum="2" colname="col2" colwidth="2*"/>
	<thead>
	  <row>
		<entry>Attribut</entry>
		<entry>Beschreibung</entry>
	  </row>
	</thead>
	<tbody>

	  <row>
		<entry>Locking</entry>
		<entry>
		  <para>
			Unter Locking versteht man das Sperren konkurrierender Zugriffe auf eine
			Datei. Bei Aktivierung dieses Auswahlkästchens sperrt Samba auf
			Client-Anfrage den Zugriff auf Dateien.
		  </para>
		  <para>
			Das Deaktivieren von Locking kann nützlich sein, um die Performance zu
			erhöhen, sollte jedoch auf Freigaben mit Schreibzugriff grundsätzlich nicht
			gesetzt werden, weil Dateien bei konkurrierenden Schreibzugriffen ohne Locking
			korrumpiert werden können.
		  </para>
		</entry>
	  </row>

	  <row>
		<entry>Blocking Locks</entry>
		<entry>
		  <para>
			Clients können einen Lock-Request mit einem Zeitlimit für einen Bereich einer
			geöffneten Datei senden.
		  </para>
		  <para>
			Kann Samba einem Lock-Request nicht entsprechen und ist diese Option aktiviert,
			so versucht Samba bis zum Ablauf des Zeitlimits periodisch den angefragten
			Dateibereich zu sperren. Ist die Option deaktiviert, wird kein weiterer Versuch
			unternommen.
		  </para>
		</entry>
	  </row>

	  <row>
		<entry>Strict Locking</entry>
		<entry>
		  <para>
			Ist diese Option aktiviert, prüft Samba bei jedem Lese- und
			Schreibzugriff, ob die Datei gesperrt ist und verweigert ggf. den Zugriff.
			Auf einigen Systemen kann dies lange dauern.
		  </para>
		  <para>
			Ist die Option deaktiviert, prüft Samba nur auf Client-Anfrage, ob eine Datei
			gesperrt ist. Gut konfigurierte Clients bitten in allen wichtigen Fällen um
			eine Prüfung, so dass diese Option im Regelfall nicht notwendig ist.
		  </para>
		</entry>
	  </row>

	  <row>
		<entry>Oplocks</entry>
		<entry>
		  Wird diese Option aktiviert, verwendet Samba so genannte
		  <emphasis>opportunistic locks</emphasis>. Dies kann die Zugriffsgeschwindigkeit auf Dateien
		  deutlich erhöhen. Allerdings erlaubt die Option Clients Dateien in großem
		  Umfang lokal zwischenzuspeichern. Deswegen kann es in unzuverlässigen
		  Netzwerken nötig sein, auf Oplocks zu verzichten.
		</entry>
	  </row>

	  <row>
		<entry>Level 2 Oplocks</entry>
		<entry>
		  <para>
			Bei Aktivierung dieser Option unterstützt Samba eine erweiterte Form der
			Oplocks, sogenannte <emphasis>opportunistic read-only locks</emphasis> oder auch Level-2-Oplocks. Windows-Clients, die ein Read-write-Oplock
			auf eine Datei halten, können dieses Oplock dann zu einem Read-only-Oplock
			herunterstufen anstatt das Oplock ganz aufgeben zu müssen, sobald ein zweiter
			Client die Datei öffnet. Alle Clients, die Level-2-Oplocks unterstützen,
			speichern dann nur Lesezugriffe auf die Datei zwischen.
			Wenn einer der Clients in die Datei schreibt, werden alle anderen Clients
			benachrichtigt, ihre Oplocks aufzugeben und ihre Zwischenspeicher zu löschen.
		  </para>
		  <para>
			Es wird empfohlen, diese Option zu aktivieren, um den Zugriff auf Dateien, die
			normalerweise nicht geschrieben werden (z.B. Programme/ausführbare Dateien)
			zu beschleunigen.
		  </para>
		  <note>
			<para>
			  Wenn Kernel-Oplocks unterstützt werden, werden Level-2-Oplocks nicht
			  bewilligt, selbst wenn die Option aktiviert ist. Die Option ist nur wirksam,
			  wenn das Auswahlkästchen <guimenu>Oplocks</guimenu> ebenfalls markiert ist.
			</para>
		  </note>
		</entry>
	  </row>

	  <row>
		<entry>Fake Oplocks</entry>
		<entry>
		  <para>
			Bei Aktivierung dieser Optionen bewilligt Samba alle Oplock-Anfragen
			unabhängig von der Anzahl auf eine Datei zugreifender Clients. Dies verbessert
			die Performance deutlich und ist
			sinnvoll bei Freigaben, auf die nur lesend zugegriffen werden kann
			(z.B. CD-ROMs) oder bei denen sichergestellt ist, dass niemals mehrere Clients
			gleichzeitig auf sie zugreifen können.
		  </para>
		  <para>
			Wenn nicht ausgeschlossen werden kann, dass mehrere Clients
			lesend und schreibend auf eine Datei zugreifen, sollte die Option nicht
			aktiviert werden, weil es sonst zu Datenverlusten kommen kann.
		  </para>
		</entry>
	  </row>

	  <row>
		<entry>Blockgröße</entry>
		<entry>
		  Die Blockgröße in Byte, in der freier Festplattenplatz an Clients
		  gemeldet werden soll. Standardmäßig beträgt sie 1024 Byte.
		</entry>
	  </row>

	  <row>
		<entry>Richtlinie für das Caching beim Client</entry>
		<entry>
		  Konfiguriert, auf welche Weise Clients Dateien aus dieser Freigabe offline
		  zwischenspeichern sollen. Zur Wahl stehen <emphasis>manuell</emphasis>, <emphasis>Dokumente</emphasis>,
		  <emphasis>Programme</emphasis> und <emphasis>deaktiviert</emphasis>.
		</entry>
	  </row>

	  <row>
		<entry>Verstecke Dateien</entry>
		<entry>
		  <para>
			Dateien und Verzeichnisse, die unter Windows nicht sichtbar sein sollen. Die
			Dateien bzw. Verzeichnisse erhalten das Datei-Attribut <emphasis>hidden</emphasis>.
		  </para>

		  <para>
			Datei- bzw. Verzeichnisnamen müssen unter Beachtung von Groß- und
			Kleinschreibung angegeben werden. Die
			einzelnen Einträge sind durch Schrägstriche zu trennen. Da der
			Schrägstrich nicht als Verzeichnistrenner eingegeben werden kann, dürfen
			nur Namen, aber keine Pfade eingetragen werden. Alle Dateien bzw. Verzeichnisse mit diesen
			Namen innerhalb der Freigabe werden dann versteckt. Die Namen dürfen
			Leerzeichen und die Platzhalter * und ? enthalten.
		  </para>

		  <para>
			<emphasis>/.*/test/</emphasis> z.B. versteckt alle Dateien und Verzeichnisse, die mit
			einem Punkt beginnen oder test heißen.
		  </para>
		  <note>

			<para>
			  Einträge in diesem Feld beeinflussen die Geschwindigkeit von Samba, da vor Anzeige
			  von Freigabeinhalten alle Dateien und Verzeichnisse auf Übereinstimmung mit
			  den gesetzten Filtern geprüft werden müssen.
			</para>
		  </note>
		</entry>
	  </row>

	  <row>
		<entry>Postexec-Skript</entry>
		<entry>
		  Ein Skript oder ein Befehl, der auf dem Server ausgeführt werden soll, wenn die Verbindung zu
		  dieser Freigabe beendet wird.
		</entry>
	  </row>

	  <row>
		<entry>Preexec-Skript</entry>
		<entry>
		  Ein Skript oder ein Befehl, der auf dem Server bei jeder Verbindungsaufnahme zu dieser
		  Freigabe ausgeführt werden soll.
		</entry>
	  </row>
	</tbody>
  </tgroup>
</table>

<table>
  <title>Reiter 'Samba-Erweiterte-Einstellungen' (erweiterte Einstellungen)</title>
  <tgroup cols="2">
	<colspec colnum="1" colname="col1" colwidth="1*"/>
	<colspec colnum="2" colname="col2" colwidth="2*"/>
	<thead>
	  <row>
		<entry>Attribut</entry>
		<entry>Beschreibung</entry>
	  </row>
	</thead>
	<tbody>

	  <row>
		<entry>Erweiterte Einstellungen für Freigaben</entry>
		<entry>
		  <para>
			Neben den standardmäßig konfigurierbaren Eigenschaften einer Samba-Freigabe
			ermöglicht diese Einstellung beliebige weitere Samba-Einstellungen an einer
			Freigabe zu setzen. Eine Liste der verfügbaren Optionen kann mit dem Befehl
			<command>man smb.conf</command> abgerufen werden. Unter <guimenu>Schlüssel</guimenu> ist der
			Name der Option anzugeben und unter <guimenu>Value</guimenu> der zu setzende Wert.
			Doppelt angegebene Konfigurationsoptionen werden nicht überprüft.
		  </para>
		  <caution>
			<para>
			  Das Setzen erweiterter Samba-Einstellungen ist nur in Sonderfällen nötig. Die
			  Optionen sollten vor dem Setzen gründlich geprüft werden, da sie
			  unter Umständen sicherheitsrelevante Auswirkungen haben können.
			</para>
		  </caution>
		</entry>
	  </row>
	</tbody>
</tgroup>
</table>

<table>
  <title>Reiter 'Erweiterte NFS-Einstellungen' (erweiterte Einstellungen)</title>
  <tgroup cols="2">
	<colspec colnum="1" colname="col1" colwidth="1*"/>
	<colspec colnum="2" colname="col2" colwidth="2*"/>
	<thead>
	  <row>
		<entry>Attribut</entry>
		<entry>Beschreibung</entry>
	  </row>
	</thead>
	<tbody>

	  <row>
		<entry>Erweiterte NFS-Einstellungen für Freigaben</entry>
		<entry>
		  <para>
			Neben den im Reiter <guimenu>NFS</guimenu> konfigurierbaren Eigenschaften einer
			NFS-Freigabe ermöglicht diese Einstellung beliebige weitere NFS-Einstellungen an einer
			Freigabe zu setzen. Eine Liste der verfügbaren Optionen kann mit dem Befehl <command>man
			5 exports</command> abgerufen werden. Doppelt angegebene Konfigurationsoptionen werden
			nicht überprüft.
		  </para>

		  <caution>
			<para>
			  Das Setzen erweiterter NFS-Einstellungen ist nur in Sonderfällen nötig. Die
			  Optionen sollten vor dem Setzen gründlich geprüft werden, da sie
			  unter Umständen sicherheitsrelevante Auswirkungen haben können.
			</para>
		  </caution>
		</entry>
	  </row>
	</tbody>
  </tgroup>
</table>


<table>
  <title>Reiter 'Optionen'</title>
  <tgroup cols="2">
	<colspec colnum="1" colname="col1" colwidth="1*"/>
	<colspec colnum="2" colname="col2" colwidth="2*"/>
	<thead>
	  <row>
		<entry>Attribut</entry>
		<entry>Beschreibung</entry>
	  </row>
	</thead>
	<tbody>


	  <row>
		<entry>Für Samba-Clients exportieren</entry>
		<entry>
		  Diese Option legt fest, ob die Freigabe für Samba-Clients exportiert werden
		  soll.
		</entry>
	  </row>

	  <row>
		<entry>Für NFS-Clients exportieren</entry>
		<entry>
		  Diese Option legt fest, ob die Freigabe für NFS-Clients exportiert werden
		  soll.
		</entry>
	  </row>

	</tbody>
  </tgroup>
</table>
</section>


<section id="shares::msdfs"><title>Unterstützung von MSDFS</title>
<para>
Das Microsoft Distributed File System (MSDFS) ist ein verteiltes Dateisystem,
das es ermöglicht, Freigaben über mehrere Server und Pfade auf eine virtuelle
Ordner-Hierarchie abzubilden. Dadurch kann die Last auf verschiedene Server
verteilt werden.
</para>
<para>
Das Setzen der <guimenu>MSDFS-Wurzel</guimenu> Option an einer Freigabe (siehe
<xref linkend="shares::management"/>) gibt an, dass es sich bei dem freigegebenen Ordner um eine
Freigabe handelt, die für MSDFS genutzt werden kann. Nur innerhalb einer
solchen MSDFS-Wurzel werden Verweise auf andere Freigaben
angezeigt, andernfalls werden diese ausgeblendet.
</para>
<para>
Um die Funktionen eines verteilten Dateisystem nutzen zu können, muss auf dem
Fileserver die &ucsUCRV; <envar>samba/enable-msdfs</envar> auf <literal>yes</literal> gesetzt
werden. Anschließend muss der Samba-Dienst neu gestartet werden.
</para>
<para>
Um einen Verweis mit dem Namen <filename class="symlink">zufb</filename> von Server <systemitem class="server">sa</systemitem> in der Freigabe <filename class="directory">fa</filename> auf die
Freigabe <filename class="directory">fb</filename> des Servers <systemitem class="server">sb</systemitem> anzulegen muss im Ordner <filename class="directory">fa</filename>
folgender Befehl ausgeführt werden.
</para>
<programlisting language="sh">
ln -s msdfs:sb\\fb zufb
</programlisting>
<para>
Dieser Verweis wird in jedem <acronym>MSDFS</acronym> fähigem Client (z.B. <systemitem class="osname">Windows 2000</systemitem> und <systemitem class="osname">Windows XP</systemitem>) als
regulärer Ordner angezeigt.
</para>
<caution>
<para>
Auf Wurzel-Verzeichnisse sollten nur eingeschränkte Benutzergruppen
Schreibzugriff haben. Andernfalls könnten Benutzer Verweise auf
andere Freigaben umlenken und so Dateien abfangen oder manipulieren.
Weiterhin müssen Pfade zu den Freigaben und die Verweise komplett klein
geschrieben werden.
Sollten Änderungen an den Verweisen vorgenommen werden, müssen beteiligte Clients
neu gestartet werden.
Weitere Informationen dazu befinden sich in der Samba Dokumentation
<biblioref linkend="samba3-howto-chapter-20"/> im Kapitel 'Hosting a Microsoft Distributed File System Tree'.
</para>
</caution>
</section>

<section id="shares::quota">
  <title>Konfiguration von Dateisystem-Quota</title>
  <para>
	UCS erlaubt die Limitierung des Speicherplatzes, den ein Benutzer auf einer Partition verwenden
	kann. Diese Schwellwerte können entweder als eine Menge von Speicherplatz (z.B. 500 MB pro
	Benutzer) oder als maximale Anzahl von Dateien ohne feste Größenbeschränkung angegeben werden.
  </para>

  <para>
	Unterschieden werden dabei zwei Arten von Schwellwerten:

	<itemizedlist>
	  <listitem>
		<para>
		  Das <emphasis>Hard-Limit</emphasis> ist die maximale Speichermenge, die ein Benutzer in Anspruch kann. Wird sie
		  erreicht, können keine weiteren Dateien angelegt werden.
		</para>
	  </listitem>

	  <listitem>
		<para>
		  Wird das <emphasis>Soft-Limit</emphasis> erreicht - das kleiner sein muss als das Hard-Limit - und liegt der
		  Speicherplatzverbrauch weiterhin unter dem Hard-Limit, wird dem Benutzer eine
		  Übergangsfrist von sieben Tagen eingeräumt um unbenutzte Daten zu löschen. Nach Ablauf der
		  sieben Tage können keine weiteren Dateien mehr angelegt oder verändert werden. Benutzern,
		  die über CIFS auf ein Dateisystem mit erschöpfter Quota zugreifen, wird eine Warnung
		  angezeigt (als Schwellwert wird dabei das Soft-Limit angesetzt).
		</para>
	  </listitem>
	</itemizedlist>
  </para>

  <para>
	Ein konfigurierter Quota-Wert von <emphasis>0</emphasis> wird als unbegrenzte Quota ausgewertet.
  </para>

  <para>
	Quotas können entweder über das UMC-Modul
	<guimenu>Dateisystem Quota</guimenu> oder über eine Richtlinie für Freigaben definiert werden,
	siehe <xref linkend="shares::quota::policy"/>.
  </para>

  <para>
	Dateisystem-Quota können nur auf Partitionen mit den Dateisystemen <systemitem class="filesystem">ext2</systemitem>, <systemitem class="filesystem">ext3</systemitem>, <systemitem class="filesystem">ext4</systemitem> und <systemitem class="filesystem">xfs</systemitem>
	angelegt werden. Bevor Dateisystem-Quota konfiguriert werden, muss der Quota-Support pro
	Partition aktiviert werden, siehe <xref linkend="shares::quota::umc"/>.
  </para>

  <section id="shares::quota::umc">
	<title>Aktivierung von Dateisystem-Quota</title>
	<para>
	  Im UMC-Modul <guimenu>Dateisystem Quota</guimenu> werden alle Partitionen aufgeführt, auf
	  denen Quota eingerichtet werden können. Es werden nur Partitionen angezeigt, die aktuell unter
	  einem Mount Point eingebunden sind.
	</para>

	<figure id="shares:quota">
	  <title>Aktivierung von Quota</title>
	  <graphic scalefit="1" width="100%" fileref="illustrations44/quota-overview-de.png"/>
	</figure>

	<para>
	  Der aktuelle Quota-Status (Aktiviert/Deaktiviert) wird angezeigt und kann mit
	  <guimenu>Aktivieren</guimenu> und <guimenu>Deaktivieren</guimenu> verändert werden.
	</para>

	<para>
	  Nachdem auf einer xfs Root-Partition Quota aktiviert wurde, muss das System neu gestartet werden
	</para>

  </section>

  <section id="shares::quota::policy">
	<title>Konfiguration von Dateisystem-Quota</title>
	<para>
	  Quotas können entweder über das UMC-Modul
	  <guimenu>Dateisystem Quota</guimenu> oder über eine Richtlinie für Freigaben definiert
	  werden, siehe <xref linkend="central:policies"/>. Die Konfiguration über die Richtlinie erlaubt die Festlegung eines Standard-Werts für
	  alle Benutzer, während das UMC-Modul eher für die flexible Konfiguration von Benutzer-Quota
	  für einzelne Benutzer geeignet ist.
	</para>

	<para>
	  Die benutzerspezifischen Quota können im UMC-Modul <guimenu>Dateisystem Quota</guimenu>
	  editiert werden. Für alle
	  aktivierten Partitionen kann mit dem Bleistift-Symbol die erlaubten Speichermengen festgelegt
	  werden. Alle Einstellungen werden benutzerspezifisch festgelegt. Mit <guimenu>Hinzufügen</guimenu>
	  können die Schwellwerte für Soft- und Hard-Limits für einen Benutzer festgelegt werden.
	</para>

	<para>
	  Die Quota-Einstellungen können auch über eine Freigaben-Richtlinie von Typ <guimenu>Benutzer-Quota</guimenu> festgelegt werden. Die
	  Einstellungen gelten für alle Benutzer einer Freigabe; es ist nicht möglich an einer Richtlinie
	  für verschiedene Benutzer unterschiedliche Quota-Limitierungen festzulegen.
	</para>

	<para>
	  Über eine Freigabe-Richtlinie gesetzte Quotaeinstellungen werden standardmäßig nur einmal
	  ausgewertet und auf das Dateisystem angewendet. Sollte sich die Einstellung ändern, wird
	  dies nicht automatisch bei der nächsten Anmeldung des Benutzers angewendet. Um geänderte
	  Quota-Werte zu übernehmen, kann an der Freigabe-Richtlinie der Punkt <emphasis>Einstellungen
	  bei jedem Login anwenden</emphasis> aktiviert werden.
	</para>

	<para>
	  Quota-Richtlinien können nur auf Partitionen angewendet werden, für die die
	  Quota-Unterstützung im UMC-Modul aktiviert wurde, siehe <xref linkend="shares::quota::umc"/>.
	</para>

	<note>
	  <para>
		Dateisystem-Quotas können immer nur auf vollständige Partitionen angewendet werden.
		Auch wenn die Richtlinien für Freigaben definiert werden, werden sie auf vollständige
		Partitionen angewendet. Wenn also beispielsweise auf einem Server drei Freigaben
		bereitgestellt werden, die alle auf der separaten <filename class="directory">/var/</filename>-Partition abgelegt werden und werden
		drei verschiedene Richtlinien konfiguriert und angewendet, so gilt die restriktivste
		Einstellung für die komplette Partition. Wenn unterschiedliche Quota verwendet werden
		sollen, wird empfohlen die Daten auf individuelle Partitionen zu verteilen.
	  </para>
	</note>
  </section>

  <section id="shares::quota::apply">
	<title>Auswertung von Quota bei der Anmeldung</title>
	<para>
	  Die im UCS-Managementsystem definierten Einstellungen werden bei der Anmeldung an UCS-Systemen
	  durch das im PAM-Stack aufgerufene Tool <command>univention-user-quota</command>
	  ausgewertet und aktiviert.
	</para>

	<para>
	  Wenn keine Quota eingesetzt werden soll, kann die Auswertung durch Setzen der &ucsUCRV;
	  <envar>quota/userdefault</envar> auf <literal>no</literal> deaktiviert werden.
	</para>

	<para>
	  Wird die &ucsUCRV; <envar>quota/logfile</envar> auf einen beliebigen Dateinamen gesetzt, wird
	  die Aktivierung der Quotas in die angegebene Datei protokolliert.
	</para>
  </section>

  <section id="shares::quota::query">
	<title>Abfrage des Quota-Status durch Administratoren oder Benutzer</title>
	<para>
	  Die für ein System definierten Quota-Begrenzungen können als Benutzer mit dem Befehl
	  <command>repquota -va</command> aufgelistet werden, z.B.:
	</para>

<screen>
*** Report für user Quotas auf Gerät /dev/vdb1
Blockgnadenfrist: 7days; Inodegnadenfrist: 7days
                        Block Limits                Dateilimits
Benutzer        belegt  weich   hart  Gnade   belegt weich hart  Gnade
----------------------------------------------------------------------
root      --      20       0       0              2     0     0
Administrator --       0       0  102400              0     0     0
user01    --  234472 2048000 4096000              2     0     0
user02    --       0 2048000 4096000              0     0     0

Statistik:
Gesamtblockzahl: 8
Datenblöcke: 1
Enträge: 4
Durchschnittlich verwendet: 4,000000
</screen>

	<para>
	  Angemeldete Benutzer können mit dem Befehl <command>quota -v</command> die für sie geltenden
	  Quota-Grenzen und die aktuelle Auslastung abfragen.
	</para>

	<para>
	  Weitergehende Informationen zu den Befehlen finden sich in den Manpages der Befehle.
	</para>
  </section>

</section>

</chapter>
